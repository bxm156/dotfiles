[tools]
node = "latest"
claude = "latest"
chezmoi = "latest"

[tasks.test]
description = "Test dotfiles in isolated container"
run = """
docker compose run --rm dotfiles-test bash -c '
  sh -c "$(curl -fsLS get.chezmoi.io)" -- -b /usr/local/bin
  chezmoi apply -v
  echo "✓ Dotfiles applied successfully"

  # Test zsh starts
  zsh -c "echo ✓ Zsh version: $ZSH_VERSION"

  # Test key tools are available
  zsh -i -c "
    command -v starship >/dev/null && echo ✓ Starship found || echo ✗ Starship missing
    echo ✓ Shell config loaded successfully
  "
'
"""

[tasks."test:interactive"]
description = "Open interactive test container"
run = "docker compose run --rm dotfiles-test"